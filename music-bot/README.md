# Whithin Music Bot

Музыкальный бот для голосовых звонков в Whithin Messenger, аналогичный Discord музыкальным ботам.

## Возможности

- Воспроизведение музыки из **Яндекс.Музыки** (по ссылке или поисковому запросу)
- Очередь треков
- Управление воспроизведением (play, pause, skip, stop)
- Регулировка громкости
- Команды через чат или Socket.IO

## Установка

```bash
cd music-bot
npm install
```

## Настройка

1. Скопируйте `.env.example` в `.env` (если есть)
2. Для работы с Яндекс.Музыкой задайте переменные:
   - **YANDEX_MUSIC_TOKEN** — OAuth-токен (получить: [OAuth Яндекса](https://oauth.yandex.ru/authorize?response_type=token&client_id=23cabbbdc6cd418abb4b39c32c41195d))
   - **YANDEX_MUSIC_UID** — числовой ID пользователя Яндекса (можно взять в настройках или из cookies)
   - Альтернатива: **YM_ACCESS_TOKEN** и **YM_UID**

## Запуск

```bash
npm start
```

Для разработки с автоперезагрузкой:

```bash
npm run dev
```

## Команды

- `!play <ссылка или запрос>` — добавить трек из Яндекс.Музыки (ссылка вида `music.yandex.ru/album/…/track/…` или поиск по названию/исполнителю)
- `!pause` — пауза
- `!resume` — продолжить
- `!stop` — остановить
- `!skip` — следующий трек
- `!queue` — показать очередь
- `!clear` — очистить очередь
- `!volume <0-100>` — громкость
- `!help` — справка

## Интеграция с сервером

Бот подключается к голосовому серверу через Socket.IO и может быть добавлен в комнату через API или команды.

## Требования

- Node.js 18+
- FFmpeg (для обработки аудио)
- Доступ к LiveKit серверу

## Примечания

Текущая реализация воспроизводит только треки из Яндекс.Музыки (по ссылке или поиску). Для production может потребоваться управление правами и персистентное хранение очередей.
